<!DOCTYPE html>
<html>
  <head>
	<title>D3 SVG Geographic Map</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="platform-0.2.0.js"></script>
	<script src="polymer-0.2.0.js"></script>
	<script src="d3.v3.min.js"></script>
	<link rel="import" href="../src/d3-geomap.html">

	<style>
		d3-geomap { display:inline-block;border:1px solid black; }
		.params { display: inline-block; vertical-align: top; }
		.params tr td:nth-of-type(1) { font-weight: bold; }
		.params tr td:nth-of-type(2) { text-align: right; }
		.params tr td:nth-of-type(3) { text-align: center; width: 200px }
		.params tr td:nth-of-type(4) { text-align: right; }
		.params tr td:nth-of-type(5) { text-align: right; width: 100px; }
		.params input[type=text] { text-align: right; width: 50px; }
	</style>
  </head>
  <body unresolved>

	<h2>Mouse Interactions</h2>
	Map background should be adjusted by mouse zoom and pan functionality.
	Zoom should stay centered, and not allow areas outside the map to be visible.
	Pan should not allow areas outside the map to be visible.

	<p />

	<polymer-element name="zoom-controller" attributes="zoom theme" noscript>
		<template>
			<d3-geomap style="width:600px;height:630px;" zoom="{{zoom}}" theme="{{theme}}"></d3-geomap>

			<table class="params">
				<tr style="height:40px"><td colspan="5"><h3>Mouse Control<h3></td></tr>
				<tr><td>Mouse Zoom Increment</td><td>1%</td><td><input type="range" onfocus="this.select()" min="1" max="100" value="{{zoom.zoomIncrement|toPercent}}" onchange="force()"></td><td>100%</td><td><input type="text" value="{{zoom.zoomIncrement|toPercent}}" onchange="force()"></td></tr>
				<tr><td>Mouse Zoom</td>				<td colspan="4" style="text-align:center"><input type="checkbox" checked?="{{zoom.zoom}}" onchange="toggleZoom(this)"></td></tr>
				<tr><td>Mouse Pan</td>				<td colspan="4" style="text-align:center"><input type="checkbox" checked?="{{zoom.pan}}" onchange="togglePan(this)"></td></tr>
				<tr><td>Mouse Zoom</td>				<td colspan="4" style="text-align:center">{{zoom.zoomScale}}</td></tr>
				<tr><td>Mouse Pan X</td>		<td>{{zoom.panX}}</td><td style="font-weight: bold;">Mouse Pan Y</td><td colspan="2" style="padding-right:10px">{{zoom.panY}}</td></tr>
				<tr style="height:80px;vertical-align:bottom;"><td colspan="5"><h3>Projection</h3></td></tr>
				<tr><td>X</td>		<td>-180째</td>	<td><input type="range" onfocus="this.select()" min="-180" max="180" value="{{zoom.x}}"></td>	<td>180째</td>	<td><input type="text" value="{{zoom.x}}"></td></tr>
				<tr><td>Y</td>		<td>-90째</td>	<td><input type="range" onfocus="this.select()" min="-90" max="90" value="{{zoom.y}}"></td>		<td>90째</td>	<td><input type="text" value="{{zoom.y}}"></td></tr>
				<tr><td>Scale</td>	<td>1x</td>		<td><input type="range" onfocus="this.select()" min="1" max="15" value="{{zoom.scale}}"></td>	<td>15x</td>	<td><input type="text" value="{{zoom.scale}}"></td></tr>
				<tr style="height:80px;vertical-align:bottom;"><td colspan="5"><h3>Theme</h3></td></tr>
				<tr><td>backgroundImage</td>		<td colspan="4"><input disabled type="text" value="{{theme.backgroundImage}}" style="width:100%;text-align:left;"></td></tr>
			</table>
		</template>
		<script>
			PolymerExpressions.prototype.toPercent = function(value) { return value * 100; }
			PolymerExpressions.prototype.toPercent.toModel = function(value) { return value / 100; }
		</script>
	</polymer-element>

	<template id="example" bind>
		<zoom-controller zoom="{{zoom}}" theme="{{theme}}"></zoom-controller>
	</template>

	<p />

<script>

	var model = {
		zoom: {
			x: 17,
			y: -2,
			scale: 5,
			zoomIncrement: 0.1,
			zoom: true,
			pan: true
		},
		theme: {
			defaultFill: 'transparent',
			borderWidth: 1,
			borderColor: '#ddd',
			backgroundImage: '../src/SRTM30_Plus/srtm30plus.jpg'
			//backgroundImage: '../src/SRTM30_Plus/srtm30plus_hilldhading_B.overview_res5km.jpg',
		}
	}

	function toggleZoom(checkbox){
		model.zoom.zoom = checkbox.checked;
	}
	function togglePan(checkbox){
		model.zoom.pan = checkbox.checked;
	}

	window.addEventListener('polymer-ready', function(){
		document.getElementById('example').model = model;
	});
</script>

  </body>
</html>